# 微信小程序学习第9天

## 每日反馈

1. 手机可以中木马病毒吗？为什么这几年都没有出现熊猫烧香这类的病毒，是因为现在安全软件越来越高级了吗？制造病毒的电脑也会中自己制造的病毒吗？
   1. 手机可以中呀。
   2. 是的。最近安全软件越来越高级
   3. 存疑

## 回顾

1. 首页静态页面+渲染

   1. 静态页面基本上就是flex
   2. uni.request渲染

2. uni.request的封装

   1. 新建request.js，对外暴露一个方法request, 方法返回一个promise对象
   2. 找一个的请求逻辑放到new Promise里面，在请求成功的回调里面，先resolve(res.data.message)
   3. 在home.vue使用，先引入，后调用
   4. request.js并不通用。请求的参数不能写死。需要传参
   5. 抽取基地址
   6. 每个页面都需要引入，麻烦。$request注册为Vue原型，每个页面可以通过this.$request访问到
   7. async和await让代码更加简洁

3. 分类页面的静态页面

   1. 抽取组件

      1. 原来home.vue里面搜索热区的结构和样式，放到components/SearchLink.vue

   2. 左右两侧分别滚动

      1. 滚动条出现的条件

         1. 内容高度大于需要滚动区域的高度

            1. 需要滚动区域的高度得是固定的

            2. .content占满剩下的屏幕

               ```
               position:absolute;
               top:100rpx;
               width:100;
               bottom:0;
               ```

         2. 需要滚动区域设置overflow:scroll或者是auto

   3. 一级分类左侧的竖线，可以用伪元素

      1. 父亲position:relative
      2. 自己postiton:absolute. content:''

#### 注意点

1. 如果hbuilder+微信开发者工具运行情况不符合预期，可能要考虑在hbuilder终端重新运行微信开发者工具
2. axios本身就会返回promise对象，黑马头条里面对axios的封装相当于我们现在request.js



## 作业检查

1. https://gitee.com/xiaomumu1002/yougou-mall/tree/mumu_20200322
   1. 完成分类页渲染
   2. 何不直接resolve(res.data.message)
   3. 可以尝试用解构来解析请求返回的数据
2. https://gitee.com/ntdntl/yougou2020
   1.  优秀
3. https://gitee.com/z1_j2_w3/my-yougou/tree/Fea-molly/
4. https://gitee.com/huang_tao971481145/uni_yougou_ht/tree/HT_yougou_one/
   1. 忘记push了？
   2. css层级不要超过4层

#### 建议：

1. 心态上不要浪费别人的时间
2. 表达方面：以邮件形式的表述



## style要不要加scoped

scoped可以把样式限定在组件内，如何做到的？

在结构和样式里面都添加唯一的属性

```html
<view class="nav data-v-ca791f8e">
```

```css
.nav.data-v-ca791f8e {
  height: 194rpx;
  display: -webkit-box;
}
```

1. 微信小程序原生语法，各个页面的的样式就是独立
2. 不建议在uniapp里面style上加scoped
3. 组件的style需要加scoped



## 分类页面

#### 02.静态页面

1. 导航栏文字的前景色和背景色提供公共的窗口样式
1. 在pages.json调整
2. 右侧的结构
   1. 顶部图片展示

   2. 二级分类和三级分类结构



#### 03.获取数据&渲染数据

接口：/api/public/v1/categories

1. 获取数据
2. 渲染左侧
3. 渲染右侧二级
4. 渲染右侧三级



## 下拉刷新

[传送门](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html)



## 上拉加载更多

[传送门](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html)



## 练习-下拉上拉-综合案例

参考<https://dev.dcloud.net.cn/mui/>

<img src="assets/image-20200304105127220.png" alt="image-20200304105127220" style="zoom:50%;" />



## 优购案例-搜索列表

<img src="../../%25E4%25BC%2598%25E8%25B4%25AD/assets/7-%25E6%2590%259C%25E7%25B4%25A2%25E5%2595%2586%25E5%2593%2581%25E5%2588%2597%25E8%25A1%25A8--goods_list.PNG" alt="7-搜索商品列表--goods_list" style="zoom:50%;" />

#### 01.页面分析

#### 02.静态页面

#### 04.请求数据&渲染数据

#### 练习说明：

#### 05.下拉刷新

#### 06.上拉加载更多

#### 07.优化



## 小程序生命周期钩子

#### 01.App生命周期

[传送门](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html)

1. App在初始化，切前台后台时会以回调函数的形式通知我们

   | 钩子函数 | 说明                             |
   | -------- | -------------------------------- |
   | onLaunch | 小程序初始化时触发（只触发一次） |
   | onShow   | 从后台进入前台                   |
   | onHide   | 从前台进入后台                   |



#### 02.Page生命周期

[Page生命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page-life-cycle.html)

Page在加载、显示、渲染完成、隐藏和销毁时会以回调函数的形式通知我们

| 钩子函数 | 说明             | 备注 |
| -------- | ---------------- | ---- |
| onLoad   | 页面加载         |      |
| onShow   | 页面显示         |      |
| onReady  | 页面初次渲染完成 |      |
| onHide   | 页面隐藏         |      |
| onUnload | 页面销毁         |      |



## Tabbar的特点

![image-20200305213027312](assets/image-20200305213027312.png)



## 页面栈

[传送门](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html)

| 路由方式   | 页面栈表现                      | 方法                        | 当前页面 | 后页面        |
| ---------- | ------------------------------- | --------------------------- | -------- | ------------- |
| 打开新页面 | 新页面入栈                      | wx.navigateTo               | onHide   | onLoad,onShow |
| 页面返回   | 页面不断出栈，直到目标返回页    | 左上角返回，wx.navigateBack | onUnload | onShow        |
| Tab切换    | 页面全部出栈，只留下新的Tab页面 | wx.switchTab                |          |               |



## 场景值

[传送门](https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html)




## 总结



## 作业

1. **搜索列表页面**
2. 理解小程序的生命周期
